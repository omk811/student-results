<script>
  let sheetData = [];

  const publicSpreadsheetUrl = 'https://docs.google.com/spreadsheets/d/1ssG6zMPQqA0XqIdihDdRPu5TZk6j2rTuAIT3fiU5E1Y/pubhtml';

  function init() {
    Tabletop.init({
      key: publicSpreadsheetUrl,
      callback: function(data) {
        console.log("📊 البيانات من Google Sheet:", data);
        sheetData = data;
      },
      simpleSheet: true
    });
  }

  function checkResult() {
    const id = document.getElementById("studentId").value.trim();
    const resultDiv = document.getElementById("result");

    console.log("🔍 البحث عن:", id);

    const student = sheetData.find(row => String(row["رقم الطالب"]).trim() === id);

    if (student) {
      console.log("✅ تم العثور:", student);
      resultDiv.textContent = "نتيجتك: " + student["النتيجة"];
      resultDiv.style.color = "green";
    } else {
      console.warn("❌ لم يتم العثور على الرقم");
      resultDiv.textContent = "عذراً، الرقم غير موجود.";
      resultDiv.style.color = "red";
    }
  }

  window.addEventListener('DOMContentLoaded', init);
</script>
