<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù†Ø¸Ø§Ù… Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø·Ù„Ø§Ø¨ - Ø§Ù„Ø£Ø³ØªØ§Ø° Ø®Ù„ÙŠÙ„ Ø§Ù„Ø¨Ù„ÙˆØ´ÙŠ</title>
  <link href="https://fonts.googleapis.com/css2?family=Baloo+Bhaijaan+2:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    /* (Ù†ÙØ³ CSS Ø§Ù„Ø³Ø§Ø¨Ù‚ ØªÙ…Ø§Ù…Ù‹Ø§ Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ±) */

    :root {
      --primary: #4361ee;
      --primary-dark: #3a56d4;
      --secondary: #7209b7;
      --accent: #f72585;
      --success: #4cc9f0;
      --warning: #ff9e00;
      --danger: #e63946;
      --light: #f8f9fa;
      --dark: #212529;
      --gray: #6c757d;
      --gradient: linear-gradient(135deg, #4361ee 0%, #7209b7 100%);
      --gradient-light: linear-gradient(135deg, #4cc9f0 0%, #4361ee 100%);
      --shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 15px 50px rgba(0, 0, 0, 0.15);
      --radius: 16px;
      --radius-sm: 8px;
      --transition: all 0.3s ease;
    }

    *{
      margin:0;padding:0;box-sizing:border-box;
    }

    body{
      font-family:'Baloo Bhaijaan 2',Tahoma;
      direction:rtl;
      background:linear-gradient(135deg,#f5f7fa 0%,#e4e8f0 100%);
      padding:20px;
      min-height:100vh;
      color:var(--dark);
    }

    /* â€¦ ÙƒÙ„ Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù€ CSS ÙƒÙ…Ø§ Ù‡Ùˆ â€¦ */

  </style>
</head>

<body>

  <div class="container">
    <header>
      <div class="logo-container">
        <div class="logo"><i class="fas fa-graduation-cap"></i></div>
        <div class="header-text">
          <h1>Ù†Ø¸Ø§Ù… Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø·Ù„Ø§Ø¨</h1>
          <p>ØªØ§Ø¨Ø¹ Ø¯Ø±Ø¬Ø§ØªÙƒ ÙˆØªØ·ÙˆØ±Ùƒ Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ Ø¨Ø³Ù‡ÙˆÙ„Ø©</p>
        </div>
      </div>
    </header>

    <div class="main-content">
      <div class="card">
        <div class="card-header">
          <h2><i class="fas fa-search"></i> Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø§Ù„Ù†ØªØ§Ø¦Ø¬</h2>
        </div>

        <div class="input-group">
          <div class="input-container">
            <input type="text" id="studentId" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ (Ù…Ø«Ù„: 1)" onkeypress="if(event.key==='Enter') checkResult()">
          </div>
        </div>

        <div class="btn-group">
          <button class="btn-primary" onclick="checkResult()">
            <i class="fas fa-chart-line"></i> Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
          </button>

          <button class="btn-secondary" onclick="loadData()">
            <i class="fas fa-sync-alt"></i> ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
          </button>

          <button class="btn-print" onclick="printTable()" id="printBtn" style="display:none;">
            <i class="fas fa-print"></i> Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬
          </button>
        </div>
      </div>

      <div class="motivational-quote">
        <div class="teacher-header">
          <i class="fas fa-user-graduate"></i> Ø§Ù„Ø£Ø³ØªØ§Ø° Ø®Ù„ÙŠÙ„ Ø§Ù„Ø¨Ù„ÙˆØ´ÙŠ
        </div>
        <div class="quote-content">
          "Ø£Ù†ØªÙ… Ø£Ø¨Ø·Ø§Ù„ Ø§Ù„Ø­Ø±ÙˆÙ ÙˆØ±ÙˆÙ‘Ø§Ø¯ Ø§Ù„ÙƒÙ„Ù…Ø§Øª..."
        </div>
      </div>
    </div>

    <div id="result"></div>
    <div class="print-section" id="printSection" style="display:none;"></div>

    <footer>
      <p>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Â© 2023 - Ù†Ø¸Ø§Ù… Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø·Ù„Ø§Ø¨ - Ø§Ù„Ø£Ø³ØªØ§Ø° Ø®Ù„ÙŠÙ„ Ø§Ù„Ø¨Ù„ÙˆØ´ÙŠ</p>
    </footer>
  </div>

  <script>
    let results = {};
    let currentStudentData = null;
    let isLoading = false;

    /* ğŸ”µ Ø¯Ø§Ù„Ø© Ø¥Ø®ÙØ§Ø¡ -1 */
    function normalizeScore(value){
      if(value === -1 || value === "-1") return "â€”";
      return value ?? 0;
    }

    /* ğŸ”µ Ø¯Ø§Ù„Ø© Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ Ø¨Ø­ÙŠØ« -1 = 0 */
    function scoreForCalc(value){
      if(value === -1 || value === "-1") return 0;
      return parseFloat(value) || 0;
    }

    const GOOGLE_SHEET_URL =
      "https://docs.google.com/spreadsheets/d/1bY6sJ2CaLy7olcCpmX6V7HMuoGZIC6G9VcPWpk0eFGw/gviz/tq?tqx=out:json";
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Google Sheets
    async function loadData() {
      if (isLoading) return;
      
      const resultDiv = document.getElementById("result");
      resultDiv.innerHTML = '<div class="result-item loading"><i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>';
      isLoading = true;

      try {
        const response = await fetch(GOOGLE_SHEET_URL);
        const text = await response.text();

        const jsonData = text
          .replace('/*O_o*/', '')
          .replace('google.visualization.Query.setResponse(', '')
          .replace(');', '');
        
        const data = JSON.parse(jsonData);

        results = {};
        const rows = data.table.rows;

        for (let i = 0; i < rows.length; i++) {
          const row = rows[i].c;
          const studentId = row[0] ? row[0].v.toString() : "";

          if (!studentId.trim()) continue;

          const oral = row[2]?.v ?? 0;
          const homework = row[3]?.v ?? 0;
          const listening = row[4]?.v ?? 0;
          const exam1 = row[5]?.v ?? 0;
          const exam2 = row[6]?.v ?? 0;
          const writing = row[7]?.v ?? 0;

          const calcTotal =
            scoreForCalc(oral) +
            scoreForCalc(homework) +
            scoreForCalc(listening) +
            scoreForCalc(exam1) +
            scoreForCalc(exam2) +
            scoreForCalc(writing);

          const final = row[9]?.v ?? 0;

          results[studentId] = {
            name: row[1]?.v ?? "ØºÙŠØ± Ù…Ø­Ø¯Ø¯",
            oral, homework, listening, exam1, exam2, writing,
            total: calcTotal,
            final
          };
        }

        resultDiv.innerHTML =
          '<div class="result-item" style="color:green; border-left:5px solid green;"><i class="fas fa-check-circle"></i> ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!</div>';

        setTimeout(() => { resultDiv.innerHTML = ""; }, 3000);

      } catch (error) {
        console.error(error);
        resultDiv.innerHTML =
          '<div class="result-item error"><i class="fas fa-exclamation-circle"></i> Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.</div>';
      } finally {
        isLoading = false;
      }
    }

    // Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø·Ø§Ù„Ø¨
    function getStudentLevel(score) {
      if (score >= 90) return "Ù…Ù…ØªØ§Ø² (A)";
      if (score >= 80) return "Ø¬ÙŠØ¯ Ø¬Ø¯Ø§ (B)";
      if (score >= 65) return "Ø¬ÙŠØ¯ (C)";
      if (score >= 50) return "Ù…Ù‚Ø¨ÙˆÙ„ (D)";
      return "ÙŠØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ù…Ø³Ø§Ø¹Ø¯Ø© (F)";
    }

    function checkResult() {
      const id = document.getElementById("studentId").value.trim();
      const resultDiv = document.getElementById("result");
      const printBtn = document.getElementById("printBtn");
      const motivationalQuote = document.querySelector('.motivational-quote');

      if (!id) {
        resultDiv.innerHTML =
          '<div class="result-item error"><i class="fas fa-exclamation-circle"></i> ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ø·Ø§Ù„Ø¨.</div>';
        printBtn.style.display = "none";
        return;
      }

      if (!results[id]) {
        resultDiv.innerHTML =
          '<div class="result-item error"><i class="fas fa-exclamation-circle"></i> Ø§Ù„Ø±Ù‚Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯.</div>';
        printBtn.style.display = "none";
        return;
      }

      // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¹Ø¨Ø§Ø±Ø© Ø§Ù„Ù…Ø­ÙØ²Ø©
      motivationalQuote.style.display = "none";

      const student = results[id];
      currentStudentData = student;

      const grandTotal =
        scoreForCalc(student.total) +
        scoreForCalc(student.final);

      const level = getStudentLevel(grandTotal);

      let tableHTML = `
        <div class="results-container">

          <div class="student-info">
            <!-- ØªÙ… Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø§Ø³Ù… Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø·Ù„Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… -->
            <div class="student-name" style="display:none;"></div>

            <div class="student-total">
              ${grandTotal}/100
            </div>
          </div>

          <div class="stats-container">

            <div class="stat-card">
              <div class="stat-icon"><i class="fas fa-chart-pie"></i></div>
              <div class="stat-value">${normalizeScore(student.total)}/60</div>
              <div class="stat-label">Ù…Ø¬Ù…ÙˆØ¹ Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø·Ù„Ø§Ø¨</div>
            </div>

            <div class="stat-card">
              <div class="stat-icon"><i class="fas fa-file-alt"></i></div>
              <div class="stat-value">${normalizeScore(student.final)}/40</div>
              <div class="stat-label">Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</div>
            </div>

            <div class="stat-card">
              <div class="stat-icon"><i class="fas fa-star"></i></div>
              <div class="stat-value">${grandTotal}/100</div>
              <div class="stat-label">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ</div>
            </div>

            <div class="stat-card">
              <div class="stat-icon"><i class="fas fa-trophy"></i></div>
              <div class="stat-value">${level.split(' ')[0]}</div>
              <div class="stat-label">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ</div>
            </div>

          </div>

          <table class="results-table">
            <tr>
              <th>Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</th>
              <th>Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©</th>
              <th>Ø¯Ø±Ø¬Ø© Ø§Ù„Ø·Ø§Ù„Ø¨</th>
            </tr>

            <tr><td>Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø´ÙÙˆÙŠ</td><td>10</td><td>${normalizeScore(student.oral)}</td></tr>
            <tr><td>Ø§Ù„ÙˆØ§Ø¬Ø¨ Ø§Ù„Ù…Ù†Ø²Ù„ÙŠ</td><td>5</td><td>${normalizeScore(student.homework)}</td></tr>
            <tr><td>Ø§Ù„ØªØ³Ù…ÙŠØ¹</td><td>5</td><td>${normalizeScore(student.listening)}</td></tr>
            <tr><td>Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù‚ØµÙŠØ± Ø§Ù„Ø£ÙˆÙ„</td><td>15</td><td>${normalizeScore(student.exam1)}</td></tr>
            <tr><td>Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù‚ØµÙŠØ± Ø§Ù„Ø«Ø§Ù†ÙŠ</td><td>15</td><td>${normalizeScore(student.exam2)}</td></tr>
            <tr><td>Ø§Ù„ØªØ¹Ø¨ÙŠØ± Ø§Ù„ÙƒØªØ§Ø¨ÙŠ</td><td>10</td><td>${normalizeScore(student.writing)}</td></tr>

            <tr class="max-score">
              <td>Ù…Ø¬Ù…ÙˆØ¹ Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø·Ù„Ø§Ø¨</td><td>60</td><td>${normalizeScore(student.total)}</td>
            </tr>

            <tr class="final-row">
              <td>Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</td><td>40</td><td>${normalizeScore(student.final)}</td>
            </tr>

            <tr class="grand-total-row">
              <td>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ</td><td>100</td><td>${grandTotal}</td>
            </tr>

            <tr class="level-row">
              <td>Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø·Ø§Ù„Ø¨</td><td colspan="2">${level}</td>
            </tr>

          </table>

          <div class="note">
            <strong>Ù…Ù„Ø§Ø­Ø¸Ø©:</strong> Ø§Ù„Ù‚ÙŠÙ… â€” ØªØ¹Ù†ÙŠ Ø£Ù† Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ù„Ù… ÙŠÙØ¯Ø±Ø¬ Ø¨Ø¹Ø¯.
          </div>

          <div style="text-align:left;margin:20px;font-weight:bold;color:var(--dark);">
            <i class="fas fa-user-graduate"></i> Ø§Ù„Ø£Ø³ØªØ§Ø° Ø®Ù„ÙŠÙ„ Ø§Ù„Ø¨Ù„ÙˆØ´ÙŠ
          </div>

        </div>
      `;

      resultDiv.innerHTML = tableHTML;
      printBtn.style.display = "flex";
    }

    function printTable() {
      if (!currentStudentData) return;

      const student = currentStudentData;
      const printSection = document.getElementById("printSection");

      const grandTotal =
        scoreForCalc(student.total) +
        scoreForCalc(student.final);

      const level = getStudentLevel(grandTotal);

      const now = new Date();
      const dateStr = now.toLocaleDateString('ar-SA');
      const timeStr = now.toLocaleTimeString('ar-SA');

      printSection.innerHTML = `
        <div style="text-align:center;margin-bottom:20px;">
          <h2>Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø·Ø§Ù„Ø¨</h2>
          <p>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©: ${dateStr} - ${timeStr}</p>
          <!-- Ø§Ù„Ø§Ø³Ù… Ù…Ø­Ø°ÙˆÙ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø·Ù„Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… -->
        </div>

        <table class="print-table">
          <thead>
            <tr>
              <th>Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</th>
              <th>Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©</th>
              <th>Ø¯Ø±Ø¬Ø© Ø§Ù„Ø·Ø§Ù„Ø¨</th>
            </tr>
          </thead>

          <tbody>
            <tr><td>Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø´ÙÙˆÙŠ</td><td>10</td><td>${normalizeScore(student.oral)}</td></tr>
            <tr><td>Ø§Ù„ÙˆØ§Ø¬Ø¨ Ø§Ù„Ù…Ù†Ø²Ù„ÙŠ</td><td>5</td><td>${normalizeScore(student.homework)}</td></tr>
            <tr><td>Ø§Ù„ØªØ³Ù…ÙŠØ¹</td><td>5</td><td>${normalizeScore(student.listening)}</td></tr>
            <tr><td>Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù‚ØµÙŠØ± Ø§Ù„Ø£ÙˆÙ„</td><td>15</td><td>${normalizeScore(student.exam1)}</td></tr>
            <tr><td>Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù‚ØµÙŠØ± Ø§Ù„Ø«Ø§Ù†ÙŠ</td><td>15</td><td>${normalizeScore(student.exam2)}</td></tr>
            <tr><td>Ø§Ù„ØªØ¹Ø¨ÙŠØ± Ø§Ù„ÙƒØªØ§Ø¨ÙŠ</td><td>10</td><td>${normalizeScore(student.writing)}</td></tr>

            <tr style="background:#fff8e1;font-weight:bold;">
              <td>Ù…Ø¬Ù…ÙˆØ¹ Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø·Ù„Ø§Ø¨</td><td>60</td><td>${normalizeScore(student.total)}</td>
            </tr>

            <tr style="background:#e3f2fd;font-weight:bold;">
              <td>Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</td><td>40</td><td>${normalizeScore(student.final)}</td>
            </tr>

            <tr style="background:#f3e5f5;font-weight:bold;font-size:20px;">
              <td>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ</td><td>100</td><td>${grandTotal}</td>
            </tr>

            <tr style="background:#fce4ec;font-weight:bold;font-size:20px;">
              <td>Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø·Ø§Ù„Ø¨</td><td colspan="2">${level}</td>
            </tr>
          </tbody>
        </table>

        <div class="note">
          <strong>Ù…Ù„Ø§Ø­Ø¸Ø©:</strong> Ø§Ù„Ù‚ÙŠÙ… â€” ØªØ¹Ù†ÙŠ Ø£Ù† Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ù„Ù… ÙŠÙØ¯Ø±Ø¬ Ø¨Ø¹Ø¯.
        </div>

        <div class="teacher-signature">
          <div style="text-align:left;margin-top:40px;">
            <div>Ø§Ù„ØªÙˆÙ‚ÙŠØ¹: ________________</div>
            <div class="teacher-name">Ø§Ù„Ø£Ø³ØªØ§Ø° Ø®Ù„ÙŠÙ„ Ø§Ù„Ø¨Ù„ÙˆØ´ÙŠ</div>
          </div>
        </div>
      `;

      printSection.style.display = "block";
      window.print();
      printSection.style.display = "none";
    }

    function showMotivationalQuote() {
      const q = document.querySelector('.motivational-quote');
      if (q) q.style.display = "block";
    }

    window.addEventListener('load', function () {
      loadData();
      showMotivationalQuote();
    });
  </script>

</body>
</html>
