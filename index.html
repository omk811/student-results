<script>
  let sheetData = [];

  const publicSpreadsheetUrl = 'https://docs.google.com/spreadsheets/d/1ssG6zMPQqA0XqIdihDdRPu5TZk6j2rTuAIT3fiU5E1Y/pubhtml';

  function init() {
    Tabletop.init({
      key: publicSpreadsheetUrl,
      callback: function(data) {
        console.log("ğŸ“Š Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Google Sheet:", data);
        sheetData = data;
      },
      simpleSheet: true
    });
  }

  function checkResult() {
    const id = document.getElementById("studentId").value.trim();
    const resultDiv = document.getElementById("result");

    console.log("ğŸ” Ø§Ù„Ø¨Ø­Ø« Ø¹Ù†:", id);

    const student = sheetData.find(row => String(row["Ø±Ù‚Ù… Ø§Ù„Ø·Ø§Ù„Ø¨"]).trim() === id);

    if (student) {
      console.log("âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ±:", student);
      resultDiv.textContent = "Ù†ØªÙŠØ¬ØªÙƒ: " + student["Ø§Ù„Ù†ØªÙŠØ¬Ø©"];
      resultDiv.style.color = "green";
    } else {
      console.warn("âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø±Ù‚Ù…");
      resultDiv.textContent = "Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø§Ù„Ø±Ù‚Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯.";
      resultDiv.style.color = "red";
    }
  }

  window.addEventListener('DOMContentLoaded', init);
</script>
